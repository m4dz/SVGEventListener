// SVGEventListener.js
// Version - 0.1.1
//
// by MAD - @madsgraphics - ecrire[at]madsgraphics.com
//
// https://github.com/madsgraphics/SVGEventListener/
//
// Tri-license - WTFPL | MIT | BSD
//
// Please minify before use.
// ##ISSUES##
//
// * FIXME: Chrome generate an error on launch :
//   Uncaught TypeError: Cannot read property 'classList' of null
//
// * FIXME: Opera uses custom addEventListener even if it supports legacy
//   versions
(function(e,t,n){"use strict";function l(e){var t,n,r=e.split(":");if(r.length==1)return t=r[0],t.lastIndexOf("ms")!=-1?parseInt(t):(t.lastIndexOf("min")!=-1?t=parseFloat(t)*60:t.lastIndexOf("h")!=-1&&(t=parseFloat(t)*3600),parseFloat(t)*1e3);r.reverse(),t=0;for(var i in r)t+=r[i]*Math.pow(60,i)*1e3;return t}function c(e){this._listeners={},this.autoFire={begin:!1,end:!1},this.parent=e}var r=n.prototype.addEventListener,i=t.createElementNS("http://www.w3.org/2000/svg","svg"),s=function(e){return typeof e=="string"},o=Array.isArray||function(e){return toString.call(e)=="[object Array]"},u=function(e){return e===undefined},a=function(e){return toString.call(e)=="[object Function]"},f=function(e){e="on"+e;var t=e in i;return t||(i.setAttribute(e,"return;"),t=a(i[e])),t};c.prototype={constructor:c,add:function(t,n){u(this._listeners[t])&&(this._listeners[t]=[]),this._listeners[t].push(n)},fire:function(t){s(t)&&(t={type:t});if(!t.target||!t.currentTarget)t.target=t.currentTarget=this.parent;if(!t.type)throw new Error("Event object missing 'type' property.");if(o(this._listeners[t.type])){var n=this._listeners[t.type];for(var r in n)n[r].call(this,t)}}},n.prototype.addEventListener=function(n,i,s){var o,a,h=this.getAttribute("begin"),p=this.getAttribute("dur"),d=this;u(this.listeners)&&(this.listeners=new c(this)),n=="endEvent"&&!f("end")&&(this.listeners.add(n,i),this.listeners.autoFire.end||(this.addEventListener("beginEvent",function(){e.setTimeout(function(){d.listeners.fire("endEvent")},l(p))}),this.listeners.autoFire.end=!0));if(n=="beginEvent"&&!f("begin")){this.listeners.add(n,i);if(h!="indefinite"&&h.indexOf(".end")==-1)this.listeners.autoFire.begin||(e.setTimeout(function(){d.listeners.fire("beginEvent")},l(h)),this.listeners.autoFire.begin=!0);else if((a=h.indexOf(".end"))!=-1){var v=t.getElementById(h.substr(0,a));v.addEventListener("endEvent",function(){d.listeners.fire("beginEvent")})}else h=="indefinite"&&(this.beginElement=function(){return this.listeners.fire("beginEvent"),this.__proto__.beginElement.call(this)})}return r.call(this,n,i,s)}})(this,document,Element);
